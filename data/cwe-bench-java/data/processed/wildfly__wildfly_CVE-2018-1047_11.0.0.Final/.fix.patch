--- a/undertow/src/main/java/org/wildfly/extension/undertow/deployment/ServletResourceManager.java
+++ b/undertow/src/main/java/org/wildfly/extension/undertow/deployment/ServletResourceManager.java
@@ -75,10 +80,19 @@ public class ServletResourceManager implements ResourceManager {
             p = p.substring(1);
         }
         if (overlays != null) {
+            String canonical = CanonicalPathUtils.canonicalize(p); //we don't need to do this for other resources, as the underlying RM will handle it
             for (VirtualFile overlay : overlays) {
-                VirtualFile child = overlay.getChild(p);
+                VirtualFile child = overlay.getChild(canonical);
                 if (child.exists()) {
-                    return new ServletResource(this, new VirtualFileResource(overlay.getPhysicalFile(), child, path));
+                    try {
+                        //we make sure the child is actually a child of the parent
+                        //CanonicalPathUtils should make sure this cannot happen
+                        //but just to be safe we do it anyway
+                        child.getPathNameRelativeTo(overlay);
+                        return new ServletResource(this, new VirtualFileResource(overlay.getPhysicalFile(), child, canonical));
+                    } catch (IllegalArgumentException ignore) {
+
+                    }
                 }
             }
         }
