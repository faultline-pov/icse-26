--- a/src/main/java/io/whitesource/cure/FileSecurityUtils.java
+++ b/src/main/java/io/whitesource/cure/FileSecurityUtils.java
@@ -22,7 +22,7 @@ public class FileSecurityUtils {
           @NonNull final String filePath, @NonNull final String baseDirPath) throws IOException {
     File file = new File(filePath);
     File baseDir = new File(baseDirPath);
-    return !file.getCanonicalPath().startsWith(baseDir.getCanonicalPath());
+    return !file.getCanonicalFile().toPath().startsWith(baseDir.getCanonicalFile().toPath());
   }
 
   /**
