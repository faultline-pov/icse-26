FROM ubuntu:22.04
ENV DEBIAN_FRONTEND=noninteractive
RUN apt -y update
RUN apt install -y curl unzip wget git build-essential
RUN mkdir -p /java-env
ENV WORKSPACE_BASE="/"
COPY ./java-env/jdk1.8.0_202 $WORKSPACE_BASE/java-env/jdk1.8.0_202
ENV JAVA_HOME=$WORKSPACE_BASE/java-env/jdk1.8.0_202
ENV PATH=$PATH:$WORKSPACE_BASE/java-env/jdk1.8.0_202/bin
ENV PATH=$PATH:$JAVA_HOME/bin
COPY ./project-sources/asf__tapestry-5_CVE-2019-0207_5.4.4 /project
COPY ./resources/my-agent/target/agent-fat.jar /project/.agent-fat.jar
ENV JAVA_TOOL_OPTIONS="-javaagent:/project/.agent-fat.jar"
WORKDIR /project
# Do not modify anything above this line
RUN ./gradlew --no-daemon -S -Dorg.gradle.dependency.verification=off clean
